<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="referrer" content="no-referrer">
    <meta name="theme-color" content="#333333">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="google" content="notranslate">
    <meta name="format-detection" content="telephone=no">
    <meta name="keyword"  content="">
    <meta name="description" content="Try not to become a man of success but rather try to become a man of value. ">
    <title>Python编码，文件编码的操作 - kinzun</title>
    <base href="/">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/icons/icon-72x72.png">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png">
    <link rel="stylesheet" href="/styles/sanitize.css">
<link rel="stylesheet" href="/styles/cold-stone.css">
    <noscript>
      <p class="text-center">你的浏览器还没开启 Javascript 功能！</p>
    </noscript>
</head>

  <body>
    

    <main class="main wrapper"><article class="article slide-in-right">
  <section>
    <h1 class="article-title">
      Python编码，文件编码的操作    </h1>
    <p class="article-meta">
      <span class="meta-info">
        LastUpdate：2019-10-25 16:52:46
        
          Tags：
          
            <a class="meta-tag" href="/tags/#Python" title="Python">Python</a>
          
        
      </span>
      <a  class="meta-link" href="/">返回</a>
    </p>
  </section>
  <section><h1 id="Python2-amp-3-编码区别"><a href="#Python2-amp-3-编码区别" class="headerlink" title="Python2&amp;3 编码区别"></a>Python2&amp;3 编码区别</h1><h5 id="Python2-X中"><a href="#Python2-X中" class="headerlink" title="Python2.X中"></a>Python2.X中</h5><p>​    编码格式默认 <code>ASCII</code>，字符串存在两种格式， <code>str</code> ,<code>unicode</code></p>
<p>因为受系统的影响所以，Python 2.x在头部加上一行编码声明。</p>
<p>编码的转换,需要转换为<code>unicode</code>为中间,</p>
<p><code>s.decode(&#39;utf-8&#39;)</code></p>
<p>受系统</p>
<p>Win GB2312</p>
<p>Linux 默认UTF-8</p>
<h5 id="Python3-X中"><a href="#Python3-X中" class="headerlink" title="Python3.X中"></a>Python3.X中</h5><p>编码默认<code>unicode</code>，python3中默认<code>unicode</code>所以字符串被直接处理作为中文，在python2有的字节串是展示不出来的。</p>
<p> 不受系统的影响统一为unicode，py文件默认为UTF-8可以不用声明</p>
<h5 id="判断编码"><a href="#判断编码" class="headerlink" title="判断编码"></a>判断编码</h5><p>1、使用isinstance(s, str)来判断一个字符串是否为一般字符串（str为ascii类型的字符串，utf-8、utf-16、GB2312、GBK等都是ascii类型的字符串）；</p>
<p>2、使用type()或者.<strong>class</strong></p>
<h5 id="查看文件"><a href="#查看文件" class="headerlink" title="查看文件"></a>查看文件</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"></span><br><span class="line"> data =open(<span class="string">u"ff.txt"</span>, <span class="string">"rb"</span>).read() </span><br><span class="line"></span><br><span class="line"> chardet.detect(data) </span><br><span class="line"></span><br><span class="line">&#123;<span class="string">'encoding'</span>: <span class="string">'GB2312'</span>, <span class="string">'confidence'</span>: <span class="number">0.99</span>, <span class="string">'language'</span>: <span class="string">'Chinese'</span>&#125;</span><br></pre></td></tr></table></figure>
<h4 id="字符编码（character-encoding）"><a href="#字符编码（character-encoding）" class="headerlink" title="字符编码（character encoding）"></a>字符编码（<strong>character encodin</strong>g）</h4><p>8 bit = 1Byte(字节)</p>
<p>编码:</p>
<ul>
<li><p>ASCII.（American Standard Code for Information Interchange，汉字内码扩展规范）</p>
<p>8bit. 1Byte</p>
</li>
<li><p>GBK.（汉字内码扩展规范） 国标码. 2Byte +&gt;&gt; 1字符</p>
<p>GB2312（中国国家标准简体中文字符集） 16bit, 2byte 两个字节表示一个字符</p>
<p>GB18030 与GBK与GB2312不同的是，GB18030采用单字节、双字节和四字节三种方式对字符编码</p>
<p>GB2312 &lt; GBK &lt; GB18030</p>
</li>
<li><p>Unicode. 万国码. 32bit, 4byte ()</p>
</li>
<li>UTF-8. 可变长度的Unicode.<br>英文: 1byte<br>欧洲: 2byte<br>中文: 3byte</li>
<li>编码之后的数据bytes<br>bytes.decode() 解码</li>
</ul>
<h5 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h5><ul>
<li>encode: 将默认编码（unicode)转换为其他编码。</li>
<li>decode: 将默认或者指定编码字符串转换为 unicode。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> s = <span class="string">"he"</span> ; s</span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line">s.decode(); u <span class="comment"># UTF-8，gbk  -&gt; UNICODE </span></span><br><span class="line"></span><br><span class="line">gb = s.encode(<span class="string">"gb2312"</span>);gb<span class="comment"># UTF-8 -&gt; GB2312</span></span><br><span class="line">gb.decode(<span class="string">"gb2312"</span>)<span class="comment"># 可以将其转换成 UNICODE。</span></span><br><span class="line"></span><br><span class="line">s.encode <span class="comment"># UNICODE -&gt; utf-8或gbk</span></span><br><span class="line"><span class="string">u'\u4e2d\u56fd\u4eba'</span></span><br><span class="line">gb.decode(<span class="string">"gb2312"</span>).encode() <span class="comment">#然后再转换成 UTF-8</span></span><br></pre></td></tr></table></figure>
<p><a href="http://python.jobbole.com/88967/" target="_blank" rel="noopener">更多</a></p>
<h4 id="文件的操作"><a href="#文件的操作" class="headerlink" title="文件的操作"></a>文件的操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">基于对位置的</span><br><span class="line"></span><br><span class="line">seek</span><br><span class="line"></span><br><span class="line">0，以文件开头，不限定打开方式。其它的两种限定要以b模式打开</span><br><span class="line"></span><br><span class="line">1， 相对于上次光标停留的位置</span><br><span class="line"></span><br><span class="line">2，从文件未尾，倒序。位置要用负数表示</span><br><span class="line">       文件操作</span><br><span class="line">            open(文件路径, mode=&quot;模式&quot;, encoding=&quot;编码&quot;)</span><br><span class="line">            模式: r, w, a, r+, w+, a+, rb, wb, ab</span><br><span class="line">            for循环可以迭代文件句柄. 拿到的是一行一行的内容</span><br><span class="line">            seek()移动光标</span><br><span class="line">            tell()查看光标位置</span><br><span class="line"></span><br><span class="line">            with open(xxxx) as f:</span><br><span class="line">                操作</span><br><span class="line"></span><br><span class="line">            文件修改:</span><br><span class="line">               从源文件中读取内容. 修改, 然后写入到新文件中. 删除源文件. 重命名新文件</span><br></pre></td></tr></table></figure>
<p>1B bytes (字节) = 8bit </p>
<p>Utf-8 中，中文1 字符 = 3 字节</p>
<p>seek（3）*<em>UTF-8中 <code>一个中文 3 个字节</code></em> 读取<code>1个字符</code></p>
<p>read(n) 读取<code>n个字符</code>，rb模式则读取的是<code>n个字节</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'te.txt'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f1:</span><br><span class="line">    connet = f1.read(<span class="number">1</span>) <span class="comment">#读取1个字节</span></span><br><span class="line">    <span class="comment">#read(n) 读取n个字符，rb模式则读取的是n个字节</span></span><br><span class="line">    f1.seek(<span class="number">3</span>) <span class="comment">#一个中文字三个字节</span></span><br><span class="line">    conn2 = f1.read()</span><br><span class="line">    print(connet)</span><br><span class="line">    print(conn2)</span><br></pre></td></tr></table></figure>
<ol>
<li><p>seek(n) 光标移动到n位置, 注意, <strong>移动的单位是byte. 所以如果是UTF-8的中⽂文部分要</strong><br><strong>是3的倍数.</strong></p>
</li>
<li><p>通常我们使⽤用seek都是移动到开头或者结尾.<br> 移动到开头: seek(0)<br> 移动到结尾: seek(0,2) seek的第⼆二个参数表⽰示的是从哪个位置进⾏行行偏移, <strong>默认是0, 表</strong> </p>
<p><strong>⽰示开头, 1表⽰示当前位置, 2表⽰示结尾</strong> </p>
</li>
</ol>
<p><a href="https://www.douban.com/note/651149148/" target="_blank" rel="noopener">一字符</a></p>
</section>
</article>

<section class="card article-toc">
  <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Python2-amp-3-编码区别"><span class="toc-text">Python2&amp;3 编码区别</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Python2-X中"><span class="toc-text">Python2.X中</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Python3-X中"><span class="toc-text">Python3.X中</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#判断编码"><span class="toc-text">判断编码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#查看文件"><span class="toc-text">查看文件</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字符编码（character-encoding）"><span class="toc-text">字符编码（character encoding）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#编码"><span class="toc-text">编码</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#文件的操作"><span class="toc-text">文件的操作</span></a></li></ol></li></ol></li></ol></li></ol>
</section>

<section class="article slide-in-right">

  <div class="loader" id="loader">
    <svg viewBox="0 0 50 50">
      <circle class="ring" cx="25" cy="25" r="20"></circle>
      <circle class="ball" cx="25" cy="5" r="3.5"></circle>
    </svg>
  </div>

  <div class="comment" id="utteranc"></div>
  <noscript>为正常使用评论功能请激活 JavaScript</noscript>
</section>

<a class="card back-to-top" id="backTop">&UpArrow;</a>

</main>

    

    <script>
	window.COLD_STONE = {
	  repo: "kinzun/kinzun.github.io",
	  gaid: "xxxxxxxxxxxxxx"
	}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.9/highlight.min.js"></script>
<script src="/scripts/cold-stone.js"></script>


  <script src="https://www.googletagmanager.com/gtag/js?id=xxxxxxxxxxxxxx"></script>

  <script>
	window.dataLayer = window.dataLayer || []
	function gtag() {
		dataLayer.push(arguments)
	}
	gtag('js', new Date())
	gtag('config', window.COLD_STONE.gaid)
  </script>


  </body>
</html>
